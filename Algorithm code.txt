The algorithm code is detailed in master 